<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>Websocket Test</title>
  </head>
  <body>
    <h2>Websocket Test</h2>

    <form id="emit" method="POST" action='#'>
      <textarea cols="50" rows="5" name="emit_data" id="emit_data" placeholder="Message here."></textarea>
      <input type="submit" value="Run">
    </form>

    <div id='log'></div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.dev.js"></script>
    <script type="text/javascript" charset="utf-8">
      $(document).ready(function() {
        var url = 'http://192.168.56.101';
        var port = '8080';

        var socket = io.connect(url + ":" + port + "/test");

        socket.on('connect', function() {
          socket.emit('connect_event', {data: 'connected!'});
        });

        socket.on('my_response', function(msg) {
          $('#log').append('<br>' + $('<div/>').text('data' + ': ' + msg.data + ', count: ' + msg.count).html());
        });

        $('form#emit').submit(function(event) {
          socket.emit('my_event', {data: $('#emit_data').val()});
          return false;
        });
      });
    </script>
  </body>
</html>
